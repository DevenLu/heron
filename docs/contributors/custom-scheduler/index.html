<!DOCTYPE html><html lang="en-us"><head><link rel="shortcut icon" type="image/png" sizes="16x16" href="/heron/img/favicon-16x16.png"><link rel="shortcut icon" type="image/png" sizes="32x32" href="/heron/img/favicon-32x32.png"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Hugo 0.14"><title>Heron Documentation - Implementing a Custom Scheduler</title><link rel="stylesheet" href="/heron/css/style.min.css"><link rel="stylesheet" href="/heron/css/font-awesome.min.css"><link rel="stylesheet" href="/heron/css/pygments.css"><script defer src="http://code.jquery.com/jquery-2.2.1.min.js"></script><script defer src="/heron/js/app.min.js"></script></head><body><nav class="hn-top-navbar navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="hn-navbar-container container-fluid"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#hn-navbar" aria-controls="hn-navbar" aria-expanded="false"><span class="sr-only"><Toggle>navigation</Toggle></span><i class="hn-toggle-button fa fa-bars"></i></button><a class="hn-navbar-logo navbar-brand" href="/heron/"><img class="pull-left" src="/heron/img/HeronTextLogo-small.png"></a></div><div id="hn-navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/heron/docs/getting-started">Docs</a></li><li><a href="/heron/docs/resources">Resources</a></li><li><a href="/heron/docs/contributors/community">Community</a></li><li><a href="https://github.com/twitter/heron">GitHub</a></li><li><a class="nav-icon" href="https://groups.google.com/forum/#!forum/heron-users"><i class="fa fa-comments"></i></a></li><li><a class="nav-icon" href="https://twitter.com/heronstreaming"><i class="fa fa-twitter"></i></a></li></ul></div></div></nav><div class="hn-main"><div class="container"><div class="row"><aside class="hn-sidebar hidden-xs col-sm-3 col-md-3 col-lg-2 collapse"><div><nav class="hn-sidebar-nav"><h4>Getting Started</h4><ul><li><a href="/heron/docs/getting-started">Local (Single Node)</a></li><li><a href="/heron/docs/upgrade-storm-to-heron">Upgrade Storm Topologies</a></li></ul><ul></ul><h4>Heron Concepts</h4><ul><li><a href="/heron/docs/concepts/topologies">Heron Topology</a></li><li><a href="/heron/docs/concepts/architecture">Heron Architecture</a></li></ul><ul></ul><h4>Deployment</h4><ul><li><a href="/heron/docs/operators/deployment">Overview</a></li><li><a href="/heron/docs/operators/deployment/configuration">Configuration</a></li></ul><ul></ul><h4>State Managers</h4><ul><li><a href="/heron/docs/operators/deployment/statemanagers/zookeeper">Zookeeper</a></li><li><a href="/heron/docs/operators/deployment/statemanagers/localfs">Local FS</a></li></ul><ul></ul><h4>Uploaders</h4><ul><li><a href="/heron/docs/operators/deployment/uploaders/localfs">Local FS</a></li><li><a href="/heron/docs/operators/deployment/uploaders/hdfs">HDFS</a></li><li><a href="/heron/docs/operators/deployment/uploaders/s3">Amazon S3</a></li></ul><ul></ul><h4>Schedulers</h4><ul><li><a href="/heron/docs/operators/deployment/schedulers/aurora">Aurora Cluster</a></li><li><a href="/heron/docs/operators/deployment/schedulers/local">Local Cluster</a></li><li><a href="/heron/docs/operators/deployment/schedulers/mesos">Mesos Cluster</a></li><li><a href="/heron/docs/operators/deployment/schedulers/slurm">Slurm Cluster</a></li></ul><ul></ul><h4>System Configuration</h4><ul><li><a href="/heron/docs/operators/configuration/config-intro">Overview</a></li><li><a href="/heron/docs/operators/configuration/instance">Heron Instance</a></li><li><a href="/heron/docs/operators/configuration/metrics-manager">Metrics Manager</a></li><li><a href="/heron/docs/operators/configuration/stmgr">Stream Manager</a></li><li><a href="/heron/docs/operators/configuration/system">System-Level</a></li><li><a href="/heron/docs/operators/configuration/tmaster">Topology Master</a></li></ul><ul></ul><h4>Observability</h4><ul><li><a href="/heron/docs/operators/observability/graphite">Graphite</a></li></ul><ul></ul><h4>User Manuals</h4><ul><li><a href="/heron/docs/operators/heron-cli">Heron Client</a></li><li><a href="/heron/docs/operators/heron-tracker-api">Heron Tracker REST API</a></li><li><a href="/heron/docs/operators/heron-tracker">Heron Tracker Runbook</a></li><li><a href="/heron/docs/operators/heron-ui">Heron UI Runbook</a></li></ul><ul></ul><h4>Topology Writers</h4><ul><li><a href="/heron/docs/developers/topologies">Writing Topologies</a></li><li><a href="/heron/docs/developers/data-model">Heron Data Model</a></li><li><a href="/heron/docs/developers/serialization">Tuple Serialization</a></li><li><a href="/heron/docs/developers/ui-guide">Heron UI Guide</a></li><li><a href="/heron/docs/developers/tuning">Tuning Guide</a></li><li><a href="/heron/docs/developers/simulator-mode">Simulator Mode</a></li><li><a href="/heron/docs/developers/troubleshooting">Troubleshooting Guide</a></li><li><a href="/heron/api">Javadoc</a></li></ul><ul></ul><h4>Heron Developers</h4><ul><li><a href="/heron/docs/developers/compiling/compiling">Compiling</a></li><li><a href="/heron/docs/developers/compiling/linux">Compiling on Linux</a></li><li><a href="/heron/docs/developers/compiling/mac">Compiling on Mac OS X</a></li><li><a href="/heron/docs/developers/compiling/docker">Compiling With Docker</a></li><li><a href="/heron/docs/contributors/testing">Running Tests</a></li><li><a href="/heron/docs/contributors/codebase">Code Organization</a></li></ul><ul></ul><h4>Extending Heron</h4><ul><li><a href="/heron/docs/contributors/custom-scheduler">Custom Scheduler</a></li><li><a href="/heron/docs/contributors/custom-metrics-sink">Custom Metrics Sink</a></li></ul><ul></ul><h4>Heron Resources</h4><ul><li><a href="/heron/docs/resources">Heron Resources</a></li></ul><ul></ul><h4>Contributors</h4><ul><li><a href="/heron/docs/contributors/community">Community</a></li><li><a href="/heron/docs/contributors/governance">Governance</a></li></ul><ul></ul></nav></div></aside><section class="hn-docs-main col-sm-9 col-md-9 col-lg-10 col-sm-offset-3 col-md-offset-3 col-lg-offset-2"><header class="hn-docs-header page-header"><h1>Implementing a Custom Scheduler</h1><div class="hn-docs-description"></div></header><article class="hn-docs-content">

<p>To run a Heron cluster, you&rsquo;ll need to set up a scheduler that is responsible
for cluster management. Heron supports three schedulers out of the box:</p>

<ul>
<li><a href="../../operators/deployment/schedulers/mesos">Mesos</a></li>
<li><a href="../../operators/deployment/schedulers/aurora">Aurora</a></li>
<li><a href="../../operators/deployment/schedulers/local">Local scheduler</a></li>
</ul>

<p>If you&rsquo;d like to run Heron on a not-yet-supported system, such as
<a href="https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html">YARN</a>
or <a href="https://aws.amazon.com/ecs/">Amazon ECS</a>, you can create your own scheduler
using Heron&rsquo;s <a href="/heron/api/scheduler/index.html">scheduler API</a>, as detailed in the
sections below.</p>

<p>Java is currently the only supported language for custom schedulers. This may
change in the future.</p>

<h2 id="java-setup:d5ff206629d5018d6f4c39fb3876767f">Java Setup</h2>

<p>In order to create a custom scheduler, you need to import the <code>scheduler</code>
library into your project.</p>

<h4 id="maven:d5ff206629d5018d6f4c39fb3876767f">Maven</h4>

<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.twitter.heron&lt;/groupId&gt;
  &lt;artifactId&gt;scheduler-api&lt;/artifactId&gt;
  &lt;version&gt;{{.Site.Params.versions.schedulerapi}}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h4 id="gradle:d5ff206629d5018d6f4c39fb3876767f">Gradle</h4>

<pre><code class="language-groovy">dependencies {
  compile group: &quot;com.twitter.heron&quot;, name: &quot;scheduler-api&quot;, version: &quot;{{.Site.Params.versions.schedulerapi}}&quot;
}
</code></pre>

<h2 id="interfaces:d5ff206629d5018d6f4c39fb3876767f">Interfaces</h2>

<p>Creating a custom scheduler involves implementing each of the following Java
interfaces:</p>

<table>
<thead>
<tr>
<th align="left">Interface</th>
<th align="left">Role</th>
<th align="left">Examples</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"><a href="/heron/api/com/twitter/heron/spi/scheduler/IConfigLoader.html"><code>IConfigLoader</code></a></td>
<td align="left">Parsing and loading of configuration for the scheduler</td>
<td align="left"><a href="/heron/api/scheduler/com/twitter/heron/scheduler/aurora/AuroraConfigLoader.html">Aurora</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/mesos/MesosConfigLoader.html">Mesos</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/local/LocalConfigLoader.html">local</a></td>
</tr>

<tr>
<td align="left"><a href="/heron/api/com/twitter/heron/spi/scheduler/ILauncher.html"><code>ILauncher</code></a></td>
<td align="left">Defines how the scheduler is launched</td>
<td align="left"><a href="/heron/api/scheduler/com/twitter/heron/scheduler/aurora/AuroraLauncher.html">Aurora</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/mesos/MesosLauncher.html">Mesos</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/local/LocalLauncher.html">local</a></td>
</tr>

<tr>
<td align="left"><a href="/heron/api/com/twitter/heron/spi/scheduler/IRuntimeManager.html"><code>IRuntimeManager</code></a></td>
<td align="left">Handles runtime tasks such as activating topologies, killing topologies, etc.</td>
<td align="left"><a href="/heron/api/scheduler/com/twitter/heron/scheduler/aurora/AuroraTopologyRuntimeManager.html">Aurora</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/mesos/MesosTopologyRuntimeManager.html">Mesos</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/local/LocalTopologyRuntimeManager.html">local</a></td>
</tr>

<tr>
<td align="left"><a href="/heron/api/com/twitter/heron/spi/scheduler/IScheduler.html"><code>IScheduler</code></a></td>
<td align="left">Defines the scheduler object used to construct topologies</td>
<td align="left"><a href="/heron/api/scheduler/com/twitter/heron/scheduler/mesos/MesosScheduler.html">Mesos</a>, <a href="/heron/api/scheduler/com/twitter/heron/scheduler/local/LocalScheduler.html">local</a></td>
</tr>

<tr>
<td align="left"><a href="/heron/api/com/twitter/heron/spi/scheduler/IUploader.html"><code>IUploader</code></a></td>
<td align="left">Uploads the topology to a shared location that must be accessible to the runtime environment of the topology</td>
<td align="left">[Aurora](), [Mesos](), <a href="/heron/api/scheduler/com/twitter/heron/scheduler/local/LocalUploader.html">local</a></td>
</tr>
</tbody>
</table>

<p>Your implementation of those interfaces will need to be on Heron&rsquo;s
<a href="https://docs.oracle.com/javase/tutorial/essential/environment/paths.html">classpath</a>
when you <a href="../../developers/compiling">compile Heron</a>.</p>

<h2 id="loading-configuration:d5ff206629d5018d6f4c39fb3876767f">Loading Configuration</h2>

<p>You can set up a configuration loader for a custom scheduler by implementing the
<a href="/heron/api/com/twitter/heron/spi/scheduler/IConfig.html"><code>IConfig</code></a>
interface. You can use this interface to load configuration from any source
you&rsquo;d like, e.g. YAML files, JSON files, or a web service.</p>

<p>If you&rsquo;d like to load configuration from files using the same syntax as Heron&rsquo;s
default configuration files for the Aurora, Mesos, and local schedulers (in
<code>heron/cli2/src/python</code>), you can implement the
<a href="/heron/api/scheduler/com/twitter/heron/scheduler/util/DefaultConfigLoader.html"><code>DefaultConfigLoader</code></a>
interface.</p>

<h2 id="configurable-parameters:d5ff206629d5018d6f4c39fb3876767f">Configurable Parameters</h2>

<p>At the very least, your configuration loader will need to be able to load the
class names (as strings) for your implementations of the components listed
above, as you can see from the interface definition for
<a href="/heron/api/com/twitter/heron/spi/scheduler/IConfigLoader.html"><code>IConfigLoader</code></a>.</p>

<h2 id="trying-out-your-scheduler:d5ff206629d5018d6f4c39fb3876767f">Trying Out Your Scheduler</h2>

<p>Once you&rsquo;ve implemented a custom configuration loader, you&rsquo;ll need to specify
your loader by class using the <code>--config-loader</code> flag. If your loader relies on
a configuration file, specify the path of that file using the <code>--config-file</code>
flag. Here&rsquo;s an example <a href="../../operators/heron-cli#submitting-a-topology">topology
submission</a> command:</p>

<pre><code class="language-bash">$ heron-cli submit &quot;topology.debug:true&quot; \
    /path/to/topology/my-topology.jar \
    biz.acme.topologies.MyTopology \
    --config-file=/path/to/config/my_scheduler.conf \
    --config-loader=biz.acme.config.MyConfigLoader
</code></pre>
</article></section></div></div></div></body></html>